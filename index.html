<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dragon's World</title>
  <style>
    body { margin: 0; background: #0d0a1a; font-family: 'Segoe UI', sans-serif; text-align: center; color: #fff; }
    h1 { font-size: 4em; margin: 0.4em 0 0.1em;
      background: linear-gradient(90deg, red, orange, yellow, green, #00cfff, violet);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    h2 { font-size: 1.4em; color: #ccc; margin-bottom: 1.5em; letter-spacing: 2px; }
    .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;
      max-width: 860px; margin: 0 auto 3em; padding: 0 20px; }
    .card { border-radius: 16px; padding: 24px 16px;
      transition: transform 0.2s, box-shadow 0.2s; border: 2px solid rgba(255,255,255,0.15); }
    .card:hover { transform: translateY(-6px) scale(1.03); box-shadow: 0 12px 32px rgba(0,0,0,0.5); }
    .icon { font-size: 3em; margin-bottom: 10px; }
    .card h3 { margin: 0 0 6px; font-size: 1.3em; }
    .element { font-size: 0.85em; font-weight: bold; text-transform: uppercase;
      letter-spacing: 1px; opacity: 0.85; margin-bottom: 8px; }
    .ability { font-size: 0.82em; color: #eee; line-height: 1.4; }
    .btn-play { margin-top: 14px; padding: 8px 24px; border: none; border-radius: 20px;
      background: rgba(255,255,255,0.2); color: #fff; font-size: 0.9em; font-weight: bold;
      cursor: pointer; letter-spacing: 1px; transition: background 0.2s; }
    .btn-play:hover { background: rgba(255,255,255,0.4); }
    .emberclaw  { background: linear-gradient(145deg, #3a0000, #8b1a00); }
    .frostfang  { background: linear-gradient(145deg, #00204a, #1a6ea8); }
    .tidesong   { background: linear-gradient(145deg, #002a2a, #0a6b6b); }
    .verdenwing { background: linear-gradient(145deg, #0a2200, #235e00); }
    .stormtalon { background: linear-gradient(145deg, #2a2200, #7a6000); }
    .shadowmend { background: linear-gradient(145deg, #1a002a, #4b0080); }
    @media (max-width: 600px) { .grid { grid-template-columns: repeat(2, 1fr); } h1 { font-size: 2.6em; } }
    #game { display: none; flex-direction: column; align-items: center; padding: 20px 0; }
    #game-title { font-size: 1.3em; color: #ccc; margin-bottom: 10px; }
    #canvas { border: 2px solid #444; border-radius: 8px; display: block; max-width: 100%; cursor: default; }
    #back-btn { margin-top: 14px; padding: 8px 22px; border: none; border-radius: 20px;
      background: rgba(255,255,255,0.15); color: #fff; font-size: 0.9em; cursor: pointer; }
    #back-btn:hover { background: rgba(255,255,255,0.3); }
  </style>
</head>
<body>
  <div id="selection">
    <h1>Dragon's World</h1>
    <h2>Choose Your Dragon</h2>
    <div class="grid">
      <div class="card emberclaw">
        <div class="icon">üî•</div>
        <h3>Emberclaw</h3>
        <div class="element" style="color:#ff6a00;">Fire</div>
        <div class="ability">Breathes a blazing inferno that melts anything in its path!</div>
        <button class="btn-play" data-color="#ff4400">‚ñ∂ Play</button>
      </div>
      <div class="card frostfang">
        <div class="icon">‚ùÑÔ∏è</div>
        <h3>Frostfang</h3>
        <div class="element" style="color:#7dd6ff;">Ice</div>
        <div class="ability">Freezes enemies solid with one mighty icy roar!</div>
        <button class="btn-play" data-color="#7dd6ff">‚ñ∂ Play</button>
      </div>
      <div class="card tidesong">
        <div class="icon">üåä</div>
        <h3>Tidesong</h3>
        <div class="element" style="color:#00e5c8;">Ocean</div>
        <div class="ability">Summons massive waves with a melodic battle cry!</div>
        <button class="btn-play" data-color="#00e5c8">‚ñ∂ Play</button>
      </div>
      <div class="card verdenwing">
        <div class="icon">üåø</div>
        <h3>Verdenwing</h3>
        <div class="element" style="color:#5ddb3a;">Forest</div>
        <div class="ability">Grows enchanted vines to trap foes and heal allies!</div>
        <button class="btn-play" data-color="#5ddb3a">‚ñ∂ Play</button>
      </div>
      <div class="card stormtalon">
        <div class="icon">‚ö°</div>
        <h3>Stormtalon</h3>
        <div class="element" style="color:#ffe033;">Sky</div>
        <div class="ability">Calls down lightning bolts from thundering storm clouds!</div>
        <button class="btn-play" data-color="#ffe033">‚ñ∂ Play</button>
      </div>
      <div class="card shadowmend">
        <div class="icon">üåë</div>
        <h3>Shadowmend</h3>
        <div class="element" style="color:#c87aff;">Dark</div>
        <div class="ability">Vanishes into darkness and strikes from the shadows!</div>
        <button class="btn-play" data-color="#c87aff">‚ñ∂ Play</button>
      </div>
    </div>
  </div>

  <div id="game">
    <div id="game-title"></div>
    <canvas id="canvas" width="800" height="500"></canvas>
    <button id="back-btn">‚Üê Back to Selection</button>
  </div>

  <script>
    const sel = document.getElementById('selection');
    const gameDiv = document.getElementById('game');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const W = canvas.width, H = canvas.height, MAP = 2000;

    const ZONES = [
      { label: 'Volcanic Wastes', color: '#5a1000', x: 0,    y: 0,    w: 1000, h: 1000 },
      { label: 'Glacial Peaks',   color: '#082240', x: 1000, y: 0,    w: 1000, h: 1000 },
      { label: 'Sunken Reef',     color: '#003020', x: 0,    y: 1000, w: 1000, h: 1000 },
      { label: 'Ancient Canopy',  color: '#052000', x: 1000, y: 1000, w: 1000, h: 1000 },
    ];

    let state, player, eggs, voidwyrm, cam, startTime, elapsed, animId, currentName = '';
    let keys = {};

    function initGame(color, name) {
      state = 'playing';
      currentName = name;
      player = { x: MAP / 2, y: MAP / 2, r: 12, color, speed: 3.5 };
      eggs = [];
      while (eggs.length < 5) {
        let ex = 150 + Math.random() * (MAP - 300);
        let ey = 150 + Math.random() * (MAP - 300);
        if (Math.hypot(ex - player.x, ey - player.y) > 260) eggs.push({ x: ex, y: ey, r: 10, collected: false });
      }
      voidwyrm = { x: 80, y: 80, r: 18, speed: 1.1 };
      cam = { x: 0, y: 0 };
      startTime = Date.now(); elapsed = 0;
      document.getElementById('game-title').textContent = `${name} ‚Äî Collect 5 eggs! Dodge the Voidwyrm!`;
    }

    function circ(x, y, r, fill, stroke, lw) {
      ctx.beginPath(); ctx.arc(x, y, r, 0, Math.PI * 2);
      ctx.fillStyle = fill; ctx.fill();
      if (stroke) { ctx.strokeStyle = stroke; ctx.lineWidth = lw || 2; ctx.stroke(); }
    }

    function drawGame() {
      cam.x = Math.max(0, Math.min(MAP - W, player.x - W / 2));
      cam.y = Math.max(0, Math.min(MAP - H, player.y - H / 2));

      ctx.save();
      ctx.translate(-cam.x, -cam.y);

      // Zone backgrounds
      ZONES.forEach(z => {
        ctx.fillStyle = z.color; ctx.fillRect(z.x, z.y, z.w, z.h);
        ctx.fillStyle = 'rgba(255,255,255,0.05)';
        ctx.font = 'bold 38px Segoe UI'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
        ctx.fillText(z.label, z.x + z.w / 2, z.y + z.h / 2);
      });

      // Grid texture
      ctx.strokeStyle = 'rgba(255,255,255,0.04)'; ctx.lineWidth = 1;
      for (let i = 0; i <= MAP; i += 100) {
        ctx.beginPath(); ctx.moveTo(i, 0); ctx.lineTo(i, MAP); ctx.stroke();
        ctx.beginPath(); ctx.moveTo(0, i); ctx.lineTo(MAP, i); ctx.stroke();
      }

      // Glowing eggs
      let t = Date.now() / 400;
      eggs.forEach(egg => {
        if (egg.collected) return;
        ctx.save();
        ctx.shadowColor = '#ffe066'; ctx.shadowBlur = 16 + Math.sin(t) * 8;
        circ(egg.x, egg.y, egg.r, '#fffab0', '#ffe066', 2);
        ctx.restore();
      });

      // Voidwyrm
      ctx.save();
      ctx.shadowColor = '#8800dd'; ctx.shadowBlur = 26;
      circ(voidwyrm.x, voidwyrm.y, voidwyrm.r, '#1a003a', '#aa33ff', 3);
      ctx.restore();

      // Player
      ctx.save();
      ctx.shadowColor = player.color; ctx.shadowBlur = 20;
      circ(player.x, player.y, player.r, player.color, '#fff', 2);
      ctx.restore();

      ctx.restore(); // end camera translate

      // HUD
      let collected = eggs.filter(e => e.collected).length;
      let mins = String(Math.floor(elapsed / 60)).padStart(2, '0');
      let secs = String(elapsed % 60).padStart(2, '0');
      ctx.fillStyle = 'rgba(0,0,0,0.62)'; ctx.fillRect(8, 8, 200, 56);
      ctx.fillStyle = '#fff'; ctx.font = 'bold 15px Segoe UI';
      ctx.textAlign = 'left'; ctx.textBaseline = 'top';
      ctx.fillText(`Time: ${mins}:${secs}`, 18, 16);
      ctx.fillText(`Eggs: ${collected} / 5`, 18, 38);

      // Game-over / win overlay
      if (state !== 'playing') {
        ctx.fillStyle = 'rgba(0,0,0,0.74)'; ctx.fillRect(0, 0, W, H);
        ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
        ctx.font = 'bold 54px Segoe UI';
        ctx.fillStyle = state === 'win' ? '#ffe033' : '#ff3344';
        ctx.fillText(state === 'win' ? 'üèÜ YOU WIN!' : 'üíÄ GAME OVER', W / 2, H / 2 - 58);
        ctx.font = '20px Segoe UI'; ctx.fillStyle = '#ccc';
        ctx.fillText(`Time: ${mins}:${secs}  ‚Ä¢  Eggs: ${collected} / 5`, W / 2, H / 2 + 2);
        // Play Again button
        ctx.fillStyle = '#ffffff'; ctx.fillRect(W / 2 - 78, H / 2 + 36, 156, 46);
        ctx.fillStyle = '#111'; ctx.font = 'bold 17px Segoe UI';
        ctx.fillText('Play Again', W / 2, H / 2 + 59);
      }
    }

    function loop() {
      if (state === 'playing') {
        elapsed = Math.floor((Date.now() - startTime) / 1000);
        const s = player.speed;
        if (keys['ArrowLeft']  || keys['a'] || keys['A']) player.x -= s;
        if (keys['ArrowRight'] || keys['d'] || keys['D']) player.x += s;
        if (keys['ArrowUp']    || keys['w'] || keys['W']) player.y -= s;
        if (keys['ArrowDown']  || keys['s'] || keys['S']) player.y += s;
        player.x = Math.max(player.r, Math.min(MAP - player.r, player.x));
        player.y = Math.max(player.r, Math.min(MAP - player.r, player.y));

        let dx = player.x - voidwyrm.x, dy = player.y - voidwyrm.y, d = Math.hypot(dx, dy);
        if (d > 1) { voidwyrm.x += (dx / d) * voidwyrm.speed; voidwyrm.y += (dy / d) * voidwyrm.speed; }
        if (d < player.r + voidwyrm.r) state = 'gameover';

        eggs.forEach(egg => {
          if (!egg.collected && Math.hypot(player.x - egg.x, player.y - egg.y) < player.r + egg.r)
            egg.collected = true;
        });
        if (eggs.every(e => e.collected)) state = 'win';
      }
      drawGame();
      animId = requestAnimationFrame(loop);
    }

    // Play Again via canvas click
    canvas.addEventListener('click', e => {
      if (state !== 'win' && state !== 'gameover') return;
      const r = canvas.getBoundingClientRect();
      const cx = (e.clientX - r.left) * (W / r.width);
      const cy = (e.clientY - r.top)  * (H / r.height);
      if (cx > W/2-78 && cx < W/2+78 && cy > H/2+36 && cy < H/2+82)
        initGame(player.color, currentName);
    });

    document.querySelectorAll('.btn-play').forEach(btn => {
      btn.addEventListener('click', e => {
        e.stopPropagation();
        const color = btn.dataset.color;
        const name = btn.closest('.card').querySelector('h3').textContent;
        initGame(color, name);
        sel.style.display = 'none';
        gameDiv.style.display = 'flex';
        canvas.focus();
        if (animId) cancelAnimationFrame(animId);
        loop();
      });
    });

    document.getElementById('back-btn').addEventListener('click', () => {
      if (animId) { cancelAnimationFrame(animId); animId = null; }
      gameDiv.style.display = 'none';
      sel.style.display = 'block';
    });

    document.addEventListener('keydown', e => {
      keys[e.key] = true;
      if (['ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].includes(e.key)) e.preventDefault();
    });
    document.addEventListener('keyup', e => { keys[e.key] = false; });
  </script>
</body>
</html>
